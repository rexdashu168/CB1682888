<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎯 Rex產業研究報告查詢系統 v2.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft JhengHei", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            padding-bottom: 80px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* 頭部 */
        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 15px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 22px;
            color: #667eea;
            margin-bottom: 5px;
        }

        .header .subtitle {
            font-size: 13px;
            color: #666;
            margin-bottom: 12px;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #eee;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 11px;
            color: #999;
            margin-top: 2px;
        }

        /* 搜尋 */
        .search-box {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .search-input-wrapper {
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 12px 80px 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 15px;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .search-btn {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 18px;
            border-radius: 10px;
            font-size: 13px;
            cursor: pointer;
        }

        .result-area {
            display: none;
        }

        .company-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        /* 公司頭部 */
        .company-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .company-name {
            font-size: 26px;
            font-weight: bold;
            color: #333;
        }

        .company-code {
            font-size: 14px;
            color: #667eea;
            margin-top: 5px;
        }

        .company-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: bold;
        }

        /* 維度導航 */
        .dimension-nav {
            display: flex;
            overflow-x: auto;
            gap: 8px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            -webkit-overflow-scrolling: touch;
        }

        .dimension-btn {
            padding: 10px 18px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            font-size: 14px;
            cursor: pointer;
            white-space: nowrap;
            flex-shrink: 0;
            transition: all 0.3s;
        }

        .dimension-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        /* 標題 */
        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
            margin: 25px 0 15px;
            display: flex;
            align-items: center;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: #667eea;
            margin-right: 10px;
            border-radius: 2px;
        }

        /* 資料格子 */
        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 12px;
            margin-bottom: 20px;
        }

        .data-item {
            background: #f8f9ff;
            padding: 15px;
            border-radius: 12px;
            border-left: 3px solid #667eea;
        }

        .data-label {
            font-size: 12px;
            color: #999;
            margin-bottom: 6px;
            font-weight: 500;
        }

        .data-value {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            word-break: break-word;
        }

        .data-value.positive { color: #22c55e; }
        .data-value.negative { color: #ef4444; }

        /* 內容卡片 */
        .content-card {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .content-title {
            font-size: 16px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
        }

        .content-text {
            font-size: 14px;
            line-height: 1.8;
            color: #555;
        }

        /* 列表 */
        .content-list {
            margin: 0;
            padding: 0;
        }

        .content-list-item {
            padding: 8px 0 8px 25px;
            position: relative;
            line-height: 1.7;
        }

        .content-list-item::before {
            content: '•';
            position: absolute;
            left: 8px;
            color: #667eea;
            font-weight: bold;
            font-size: 18px;
        }

        /* 報告卡片 */
        .report-card {
            background: white;
            border-radius: 15px;
            padding: 18px;
            margin-bottom: 15px;
            border: 2px solid #f0f0f0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .report-card:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
            transform: translateY(-2px);
        }

        .report-card.expanded {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .report-date {
            font-size: 16px;
            color: #667eea;
            font-weight: bold;
        }

        .report-broker {
            font-size: 12px;
            color: #999;
            margin-top: 4px;
        }

        .report-type {
            background: #667eea;
            color: white;
            padding: 6px 14px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .report-type:hover {
            background: #5568d3;
            transform: scale(1.05);
        }

        .report-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 12px;
        }

        .report-detail {
            display: none;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px dashed #e0e0e0;
        }

        .report-card.expanded .report-detail {
            display: block;
        }

        /* 時間軸 */
        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #667eea;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 20px;
            padding-left: 10px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -24px;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #667eea;
            border: 3px solid white;
        }

        .timeline-time {
            font-size: 14px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .timeline-event {
            font-size: 14px;
            color: #555;
            line-height: 1.6;
        }

        .timeline-impact {
            font-size: 12px;
            color: #999;
            margin-top: 5px;
        }

        /* QA */
        .qa-container {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .qa-item {
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 2px dashed #e0e0e0;
        }

        .qa-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .qa-question {
            background: #667eea;
            color: white;
            padding: 12px 15px;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 12px;
            line-height: 1.6;
            display: flex;
            align-items: flex-start;
        }

        .qa-question::before {
            content: 'Q';
            background: white;
            color: #667eea;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: bold;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .qa-answer {
            background: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            line-height: 1.8;
            color: #555;
            border-left: 3px solid #22c55e;
        }

        .qa-answer::before {
            content: 'A: ';
            font-weight: bold;
            color: #22c55e;
            font-size: 15px;
        }

        /* 標籤 */
        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }

        .tag {
            padding: 6px 12px;
            background: white;
            border: 2px solid #667eea;
            border-radius: 15px;
            font-size: 12px;
            color: #667eea;
            font-weight: 500;
        }

        /* 空狀態 */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }

        .empty-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }

        /* 產品表格 */
        .product-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 15px;
        }

        .product-table th {
            background: #667eea;
            color: white;
            padding: 12px;
            text-align: left;
            font-size: 13px;
            font-weight: 600;
        }

        .product-table td {
            padding: 12px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 13px;
            line-height: 1.6;
        }

        .product-table tr:last-child td {
            border-bottom: none;
        }

        @media (max-width: 600px) {
            .company-name {
                font-size: 20px;
            }
            .data-grid {
                grid-template-columns: 1fr;
            }
            .report-summary {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 產業研究報告查詢系統 v2.0</h1>
            <div class="subtitle">完整資訊 | 智能分析 | 深度追蹤</div>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalReports">-</div>
                    <div class="stat-label">研究報告</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalCompanies">-</div>
                    <div class="stat-label">追蹤公司</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalIndustries">-</div>
                    <div class="stat-label">產業分類</div>
                </div>
            </div>
        </div>

        <div class="search-box">
            <div class="search-input-wrapper">
                <input type="text" 
                       class="search-input" 
                       id="searchInput" 
                       placeholder="輸入股票代號或公司名稱 (如: 2330 或 台積電)">
                <button class="search-btn" id="searchBtn">查詢</button>
            </div>
        </div>

        <div class="result-area" id="resultArea">
            <div class="company-card" id="companyCard"></div>
        </div>
    </div>

    <script>

        const RESEARCH_DATA = {"stats": {"total_reports": 10, "total_companies": 5, "total_industries": 3}, "companies": {"1519": {"company_name": "華城", "stock_code": "1519", "industry": "電機機械", "status": "🔥重點追蹤", "report_count": 1, "latest_report": "2023/12/15", "rating": "買進", "target_price": "420", "memo": "重電之王、全台唯一500kV變壓器、美國基建訂單至2026", "basic_info": {"market": "上市", "industry_detail": "變電設備,配電盤,電力設備", "related_category": "ETF成份股–(0051) 元大中型100,ETF成份股–(006203) 元大MSCI台灣,ETF成份股–(0057) 富邦摩台", "industry_position": "生產電力變壓器為主之重電廠", "price": 746.0, "price_change": -19.0, "price_change_pct": -2.48, "volume": 1587.0, "capital": 31.6, "market_cap": 2356.0, "years_established": 56.2, "years_listed": 28.6, "chairman": "許邦福", "ceo": "許逸德/許逸晟(執行長)"}, "finance": {"revenue_3q": "131.1億 (2023F)", "revenue_yoy": "+69.15% YoY", "revenue_qoq": "報告未提及", "gross_margin": "31.09%", "gross_margin_yoy": "報告未提及", "net_profit": "22.69億 (2023F)", "net_profit_yoy": "+170.73% YoY", "eps": "8.69 (2023F)", "guidance_4q": "2024F: 產能擴增30-40%、營收171.5億、EPS 13.12"}, "products": {"product1": {"name": "變壓器", "performance": "71.39% (2023)、500kV全台唯一"}, "product2": {"name": "配電盤", "performance": "12.63%"}, "product3": {"name": "工程統包", "performance": "5.91%"}, "growth_driver": "美國基建(IIJA+IRA 1.637兆美元)、非晶質變壓器(減碳20%)", "outlook_2026": "訂單能見度至2026、2024產能擴增30-40%"}, "reports": [{"id": 54, "date": "2023/12/15", "broker": "群益投顧", "analyst": "吳建弘", "type": "個股報告", "importance": "⭐⭐⭐⭐⭐", "revenue_yoy": "+69.15% (2023F)", "gross_margin": "31.09% (2023F)", "eps": "8.69 (2023F)"}], "detail": [{"id": 54, "operations": "【群益投顧 吳建弘 2023/12/15 - 買進、目標價420元】\n\n投資建議: 重電之王\n1. 華城受惠美國與台灣等地的淨零轉型趨勢、產品組合大幅改善\n2. 考量COP28氣候峰會要求的2030年能源效率提升100%、有利新型變壓器出貨\n3. 華城是全台唯一生產500kV變壓器的廠商\n4. 給予華城Buy投資建議、目標價420元(32X 2024F EPS)\n\n2023年受惠美國基礎政策、海外變壓器需求明顯增溫:\n5. 受惠美國兩大基礎政策: IIJA與IRA共計10年1.637兆美元基建預算\n6. 華城訂單能見度達2026年\n7. 帶動高毛利率海外變壓器需求上升\n8. 3Q23稅後淨利7.13億元(QoQ +31.12%)、EPS 2.73元\n\n4Q23國內工程旺季、營運持續增長:\n9. 預期4Q23美國基建需求持續\n10. 4Q23是傳統國內工程旺季、國內營收貢獻較多\n11. 預估4Q23營收48.23億元(QoQ +32.33%)\n12. 稅後純益8.07億元(QoQ +13.18%)、EPS 3.09元", "strategy": "2024年擴大產能、因應2050年淨零碳排需求:\n1. 持續受惠美國2050年淨零碳排的美國基建需求\n2. 訂單能見度已達2026年\n3. 預期華城2024年將加大資本支出\n4. 透過加班、產線優化、購買機台等、產能上升30-40%\n5. 2024年營收171.53億元(YoY +30.84%)\n6. 稅後純益34.26億元(YoY +50.97%)、EPS 13.12元\n\nCOP28氣候峰會近況追蹤:\n7. 過去電網投資有限、造成政策無法滿足2050碳中和目標\n8. COP28氣候峰會、各國政府同意2030年能源效率增加100%\n9. 新型-非晶質變壓器相較傳統變壓器可減少20%碳排\n10. 研究部預期未來重電投資可望加大\n\n美國基礎政策:\n11. IIJA(基礎建設投資和就業法案): 1.2兆美元、2022-2031\n12. IRA(抗通膨法案): 4,370億美元、2022-2031\n13. 涵蓋能源/電力設施/水利/寬頻網路等\n14. 重建美國基建、提高氣候適應能力與永續發展", "qa": "(群益為個股報告、無QA內容)\n\n但報告提及重點:\n1. 華城成立於1969年、自成立以來逐步與日本戶上電機、日立公司、高越製作所合作\n2. 累積多年海內外生產345kV變壓器成績後、於2013年與日商日立製造所合作生產500kV超高變壓器\n3. 進軍國際市場、當前已成為國內唯一、東南亞最大500kV電壓的世界級重電變壓器廠商\n4. 2022年外銷佔比29%、內銷71%\n5. 01/2023-11/2023產品佔比: 變壓器71.39%、配電盤12.63%、工程統包5.91%、配電器材3.36%、售電收入0.17%", "rex_view": "正面因素:\n- 群益給予「買進」投資建議、目標價420元(32X 2024F EPS)\n- 全台唯一500kV變壓器廠商、技術門檻高\n- 美國基建訂單能見度至2026年、營收成長確定性高\n- 2024產能擴增30-40%、因應訂單成長\n- COP28要求2030能源效率+100%、政策支持\n- 非晶質變壓器減碳20%、符合淨零趨勢\n- 2024 EPS 13.12元、2023-2024高速成長期\n- 與日立等國際大廠合作、技術領先\n\n需要關注:\n- 產能擴充能否如期完成\n- 國際競爭加劇\n- 原物料成本波動\n- 匯率風險\n- 政策變化風險\n\n投資啟示:\n- 群益給予最高評價: 買進、目標價420元\n- 評價以2024 EPS 13.12元計算、給予32倍本益比\n- 重電之王、技術門檻高、訂單能見度至2026\n- 受惠淨零轉型趨勢、COP28政策支持\n- 2024產能擴增30-40%、營運高成長", "follow_up": "- 4Q23實際營收與EPS表現\n- 2024產能擴充進度(目標30-40%)\n- 美國基建訂單持續性\n- COP28後各國重電投資政策\n- 非晶質變壓器滲透率\n- 2024實際營收與EPS能否達標\n- 2026年後訂單能見度\n- 國際競爭態勢\n- 原物料成本趨勢", "tags": "#群益買進 #目標價420 #重電之王 #500kV唯一 #美國基建 #COP28 #產能擴增30-40% #非晶質變壓器"}], "timeline": [{"time": "2024", "event": "產能擴增30-40%", "type": "產能擴充", "importance": "⭐⭐⭐⭐⭐", "impact": "因應2050淨零"}, {"time": "2026", "event": "美國基建訂單持續", "type": "訂單能見度", "importance": "⭐⭐⭐⭐⭐", "impact": "營收成長"}, {"time": "2030", "event": "COP28能源效率+100%", "type": "政策推動", "importance": "⭐⭐⭐⭐⭐", "impact": "新型變壓器需求"}]}, "1717": {"company_name": "長興", "stock_code": "1717", "industry": "PCB材料設備", "status": "追蹤", "report_count": 1, "latest_report": "2025/10/23", "rating": "未評等", "target_price": null, "memo": "真空壓模機載板95%市佔、乾膜光阻、玻璃基板PI材料、美國設廠優勢", "basic_info": {"market": "上市", "industry_detail": "合成樹脂,化學工業,半導體化學品", "related_category": "ETF成份股–(006204) 永豐臺灣加權,ETF成份股–(00850) 元大臺灣ESG永續,ETF成份股–(00701) 國泰股利精選30", "industry_position": "全球最大乾膜光阻劑廠商之一、前三大UV光固化樹脂廠", "price": 38.9, "price_change": -1.3, "price_change_pct": -3.23, "volume": 4679.0, "capital": 117.0, "market_cap": 456.0, "years_established": 60.9, "years_listed": 31.6, "chairman": "高國倫", "ceo": "毛惠寬"}, "finance": {}, "products": {"product1": {"name": "真空壓模機", "performance": "載板95%市佔、橡膠式+氣囊式"}, "product2": {"name": "乾膜光阻", "performance": "AI應用、美國設廠優勢"}, "product3": {"name": "PI材料", "performance": "玻璃基板RDL/Hybrid Bump/TGV"}, "growth_driver": "IC載板/HDI成長最快、18層+PCB成長快", "outlook_2026": "2Q27馬來西亞設廠、供應泰國/馬來西亞客戶"}, "reports": [{"id": 14, "date": "2025/10/23", "broker": "國泰證期", "analyst": "未提供", "type": "TPCA Call Memo", "importance": "⭐⭐⭐⭐", "revenue_yoy": "報告未提及", "gross_margin": "報告未提及", "eps": "報告未提及"}], "detail": [{"id": 14, "operations": "【國泰證期 2025/10/23 - TPCA Call Memo】\n\n設備業務-真空壓模機:\n1. 公司致力於設備研發、特別是真空壓模機、並搭配預貼機實現載板全自動化生產\n2. 主要分為氣囊式壓模和橡膠平台式壓模、根據不同材料應用推薦客戶選擇最適合加壓方式\n3. ABF產業主要使用橡膠式壓台、透過平壓式檯面進行真空均勻性加壓、達到ABF膜面均勻性要求\n4. 在多層增層板、公司在載板領域有高達95%的業界市佔率\n5. 氣囊式壓模主要應用於一般乾膜部分、因乾膜受環境溫度和黏度影響、從上檯面進行氣囊充氣加壓\n\n材料業務-乾膜光阻:\n6. 2025年趨勢是針對AI所需運用到的乾膜光阻材料\n7. 在PCB產業、客戶到哪裡公司產線就做到哪、PCB最多在中國\n8. 關稅問題促使PCB廠往東南亞\n9. 公司在台灣、中國、義大利都有產線\n10. 長興是唯一乾膜光阻廠商在美國有設廠的、已設二三十年、是公司在美國銷售優勢\n11. 2Q27也會在馬來西亞設產線、主要為供應泰國和馬來西亞區域客戶、提供就近服務", "strategy": "產品應用與技術:\n1. 現在在PCB應用上、成長最大是IC載板、再來是HDI、再來是多層板\n2. 18層以上成長很快、一般應用PCB跟軟板成長比較持平\n3. IC載板曝光機分兩種: 雷射型曝光機、投射式曝光機、因應曝光機不同材料也要不一樣\n4. UDH5700解析能力可達44等級、APR906可做到2.5解析能力、除解析還可幫客戶調整\n5. 載板曝光不是重點、載板要良率、需要比較穩定的材料\n6. HDI跟一般應用需要曝光速度\n\n玻璃基板封裝材料:\n7. 長興材料在玻璃基板封裝的解決方案、以PI材料做、分為三個主軸\n8. 第一個是感光型PI、做在RDL層\n9. 第二個是Hybrid Bump材料、用在晶片對晶片接合、正在開發測試中\n10. 第三個是PI在TGV做PI層塗布、一方面保護玻璃、也可做金屬化讓銅可以電鍍\n11. 主要是RDL層在量產、有小量訂單\n12. 另外兩個在開發中\n13. 先進封裝廠OSAT廠目前仍在送樣測試中\n14. 國內競爭對手: 達興、永光、都有類似PI材料\n15. 公司沒有做設備、所以要搭配設備商", "qa": "(TPCA Call Memo、無正式QA)\n\n但報告提及重點:\n1. PCB最多在中國、關稅促使往東南亞\n2. 公司是唯一在美國設廠的乾膜光阻廠商\n3. 2Q27馬來西亞設產線供應泰國/馬來西亞\n4. IC載板成長最大、其次HDI、再來多層板\n5. 18層以上PCB成長很快\n6. 玻璃基板封裝PI材料三主軸: 感光型PI(RDL層)、Hybrid Bump、TGV PI層\n7. RDL層PI已量產有小量訂單、另兩個開發中\n8. OSAT廠送樣測試中\n9. 競爭對手: 達興、永光", "rex_view": "正面因素:\n- 載板真空壓模機95%市佔率、絕對龍頭\n- 唯一在美國設廠的乾膜光阻廠商、銷售優勢\n- 全球布局完整(台灣/中國/義大利/美國)\n- 2Q27馬來西亞設廠、深化東南亞布局\n- IC載板成長最大、受惠AI趨勢\n- 18層+PCB成長快、高階化趨勢\n- 玻璃基板封裝PI材料已小量量產\n- RDL層PI有訂單、技術領先\n\n需要關注:\n- 中國PCB廠往東南亞移動影響\n- 關稅政策不確定性\n- 玻璃基板Hybrid Bump/TGV仍在開發\n- OSAT廠送樣測試進度\n- 達興/永光競爭\n\n投資啟示:\n- Call Memo無明確投資評等\n- 載板設備絕對龍頭地位(95%市佔)\n- 美國設廠優勢明確\n- 東南亞布局持續深化\n- IC載板/HDI/18層+PCB成長受惠廠商\n- 玻璃基板封裝材料先行布局", "follow_up": "- 馬來西亞設廠進度\n- IC載板成長持續性\n- 18層+PCB需求\n- 玻璃基板PI材料量產進度\n- Hybrid Bump/TGV開發時程\n- OSAT廠認證進度\n- 美國市場拓展\n- 東南亞客戶開發\n- 達興/永光競爭態勢", "tags": "#國泰TPCA #載板壓模機95%市佔 #美國設廠唯一 #馬來西亞2Q27 #玻璃基板PI #IC載板成長"}], "timeline": [{"time": "2Q27", "event": "馬來西亞設廠", "type": "產能擴充", "importance": "⭐⭐⭐", "impact": "供應東南亞"}]}, "1815": {"company_name": "富喬", "stock_code": "1815", "industry": "上市電子零組件", "status": "🔥重點追蹤", "report_count": 1, "latest_report": "2024/02/01", "rating": "買進", "target_price": "32", "memo": "Low DK、台光電認證", "basic_info": {"market": "上櫃", "industry_detail": "玻纖布,印刷電路板相關", "related_category": "ETF成份股–(00984A) 主動安聯台灣高息", "industry_position": "台灣玻纖紗、玻纖布一貫廠", "price": 75.0, "price_change": -5.0, "price_change_pct": -6.25, "volume": 125001.0, "capital": 52.1, "market_cap": 391.0, "years_established": 26.8, "years_listed": 19.8, "chairman": "張元賓", "ceo": "陳壁程"}, "finance": {"revenue_3q": "報告未提及", "revenue_yoy": "報告未提及", "revenue_qoq": "報告未提及", "gross_margin": "Low DK為一般2.5倍", "gross_margin_yoy": "報告未提及", "net_profit": "報告未提及", "net_profit_yoy": "報告未提及", "eps": "2.0(2024E)", "guidance_4q": "產能升至30%"}, "products": {"product1": {"name": "Low DK玻纖布", "performance": "ASP為一般5倍、毛利2.5倍"}, "product2": {"name": "電子級玻纖", "performance": "報告未提及"}, "product3": {"name": "工業級玻纖", "performance": "報告未提及"}, "growth_driver": "AI server/Switch、台光電認證", "outlook_2026": "產能持續擴充、台光電量大"}, "reports": [{"id": 53, "date": "2024/02/01", "broker": "報告未提供", "analyst": "報告未提供", "type": "產業分析", "importance": "⭐⭐⭐⭐", "revenue_yoy": "報告未提及", "gross_margin": "報告未提及", "eps": "2.0"}], "detail": [{"id": 53, "operations": "Low DK玻纖布台光電2月認證通過、3月小量Q2放量(Switch 400G/800G搶LDK原料)、ASP為一般電子級5倍以上、毛利為一般2.5倍、建榮被台光電退件、台玻廠內佔比<10%", "strategy": "台灣擴產:產能從10%逐步提升至Q4 30%(2024-2025持續擴產)、泰國子公司設立、客戶:台光電(Switch+Server量為台燿3-4倍)、台燿、聯茂、打入Server供應鏈、應用:AI server與Switch用Low DK材料", "qa": "報告未提供詳細QA", "rex_view": "產業優勢:台灣唯二可自製玻纖紗/布供應商、Low DK嚴重短缺(日東Nittobo轉做更高毛利Low DK2)、國內CCL廠台燿/台光電/聯茂缺料;成長確定:台光電認證成功、量為台燿3-4倍、產能Q4升至30%、2024轉虧為盈;投資建議:買進、2024E EPS 2、目標價32(16倍PE)、目前股價<20", "follow_up": "台光電訂單放量(3月小量Q2放量)、產能爬坡進度(Q4達30%)、泰國廠設立進度、Server供應鏈訂單、2024獲利轉正、毛利率維持", "tags": "#LowDK玻纖布 #富喬 #台光電認證 #AI #Switch #買進"}], "timeline": [{"time": "2024-2025", "event": "Low DK產能擴充", "type": "產能擴充", "importance": "⭐⭐⭐⭐⭐", "impact": "產能10%→Q4 30%"}]}, "2301": {"company_name": "光寶科", "stock_code": "2301", "industry": "電源供應器", "status": "🔥重點追蹤", "report_count": 3, "latest_report": "2025/10/30", "rating": "未評等(CTBC)/區間操作(第一金)/買進(永豐)", "target_price": "103(第一金)/210(永豐)", "memo": "AI電源龍頭、BBU產能2026訂滿、散熱CDU、永豐目標價210", "basic_info": {"market": "上市", "industry_detail": "汽機車零組件,車用電池,車用電子,LED,LED封裝,LED照明產品,電源供應器,無線充電,機殼,電子其他,電子零件元件,鍵盤,光碟機／燒錄機,無線網路設備系統(WLAN),通訊設備,事務機器,週邊產品,光通訊,太陽能,PV Inverter,電腦系統業,光纖被動元件", "related_category": "光碟機,通信網路,ETF成份股–(0052) 富邦科技,ETF成份股–(0050) 元大台灣50,ETF成份股–(0053) 元大電子", "industry_position": "台灣電源供應器大廠", "price": 166.5, "price_change": -2.5, "price_change_pct": -1.48, "volume": 12088.0, "capital": 232.0, "market_cap": 3857.0, "years_established": 36.7, "years_listed": 30.0, "chairman": "宋明峰", "ceo": "邱森彬"}, "finance": {"revenue_3q": "449億 (3Q25)", "revenue_yoy": "+22% YoY", "revenue_qoq": "+11% QoQ", "gross_margin": "25.0%", "gross_margin_yoy": "+2.9ppts QoQ", "net_profit": "46.5億", "net_profit_yoy": "報告未提及", "eps": "2.05 (3Q25)", "guidance_4q": "4Q25核心事業年季雙成長、2026AI佔比超過25%"}, "products": {"product1": {"name": "雲端及物聯網", "performance": "48% (3Q25)、新世代高階電源出貨"}, "product2": {"name": "資訊及消費性產品", "performance": "36% (3Q25)、IT高階電源/低軌衛星/智慧輸入"}, "product3": {"name": "光電部門", "performance": "16% (3Q25)、Mini LED/不可見光應用"}, "growth_driver": "AI電源(PSU 80%+BBU 15%)/散熱CDU/Power Rack/HVDC", "outlook_2026": "2025 AI佔比20%、2026超過25%、BBU 2026產能訂滿"}, "reports": [{"id": 10, "date": "2025/10/30", "broker": "中國信託證券", "analyst": "邱繼銓", "type": "個股報告", "importance": "⭐⭐⭐⭐", "revenue_yoy": "+22% (3Q25)", "gross_margin": "25.0%", "eps": "2.05 (3Q25)"}, {"id": 19, "date": "2025/10/08", "broker": "永豐投顧", "analyst": "張智皓", "type": "個股報告", "importance": "⭐⭐⭐⭐⭐", "revenue_yoy": "+21.4% (2025E)", "gross_margin": "23.0% (2025E)", "eps": "6.38 (2025E)"}, {"id": 52, "date": "2024/05/07", "broker": "第一金投顧", "analyst": "蔡政杰", "type": "動態更新", "importance": "⭐⭐⭐", "revenue_yoy": "-6.45% (2024E)", "gross_margin": "報告未提及", "eps": "5.73 (2024E)"}], "detail": [{"id": 10, "operations": "【中國信託證券 邱繼銓 2025/10/30 - 未評等】\n\n財務表現:\n1. 3Q25營收449億元(YoY +22%, QoQ +11%)\n2. 毛利率25.0%(YoY +260bps, QoQ +290bps)、受台幣急升影響\n3. 營業費用65.6億元(YoY +52%, QoQ +26%)、主要為出貨相關費用與研發投入\n4. 營業淨利率10.4%(YoY -30bps, QoQ +120bps)\n5. 稅後淨利46.45億元(YoY +37%, QoQ +47%)、EPS 2.05元\n\n營收結構:\n6. 雲端&IoT: 215億(48%)、QoQ +28%、OP 33億、QoQ +78%\n7. 光電: 70億(16%)、QoQ -8%、OP 6億、QoQ -18%\n8. 資訊&消費: 165億(36%)、QoQ +2%、OP 17億、QoQ +17%\n9. AI產品組合: 高階電源(PSU+BBU)佔雲端事業~50%\n10. 2025 AI佔整體營收比重上修至~20%(原15%)、26E佔比>20%", "strategy": "董事會決議:\n1. 越南子公司增資USD 2億、用於營運成長與產能擴充\n2. 核准發行國內CB上限NT$120億、5年期/票面利率0%、採競價拍賣與全額交割承銷\n\n產品&技術(OCP展示):\n3. MW等級整合式電源與液冷: 800V HVDC PowerRack、BPU capacitor shelf\n4. 散熱解決方案: 2.1MW in-row CDU、280kW in-rack CDU、140kW L2A sidecar\n5. 從關鍵零組件到系統整合的供應能力\n\n4Q25/2026展望:\n6. 4Q25: PowerShelf/BBU持續穩定放量、新一代110kW PowerShelf、新CDU、400V PowerRack陸續量產\n7. 2026: BBU 4Q25產能規模維持、BBU產能2026已被客戶包下\n8. 產能擴充: 泰國/高雄/美國德州產能擴增近一倍\n9. 新客戶: 現有CSP單一客戶成長外、已新增客戶線、26E有機會再新增\n10. 中長期: 從「零組件供應商」走向「系統整合解決方案提供者」", "qa": "Q1: OPM是否有機會隨product mix改善而提升?\nA: 以提高GP支應OPEX、OPM現階段目標維持10%、R&D約佔營收5.5%-6%、未來希望提升到6%\n\nQ2: 2026年初步看法?\nA: 沒有悲觀理由、2026狀況會跟4Q25差不多(QoQ成長幅度)\n\nQ3: CapEx?\nA: 25E CapEx YoY+25%、26E將延續海外產線擴充趨勢(YoY+25%)\n\nQ4: BBU/PSU產能與區域?\nA: 4Q25持續擴充產能、2026 BBU產線區域比重Plano 3:高雄4:中國3\n\nQ5: BBU滲透率?\nA: 客戶已經將明年產能都包下、2026營收規模會高於2025年\n\nQ6: Power rack規格?\nA: 現有400V客製案約500kW/櫃、平台與配置依客戶系統需求、產業尚無統一標準\n\nQ7: SST研發?\nA: 已投入SST研發、目前在初期階段、未來趨勢是直流高壓\n\nQ8: DC-DC module開發?\nA: 目前無AI伺服器相關量產出貨、持續開發中、與半導體大廠合作新技術規避IP風險、26E有望展示樣品\n\nQ9: 稅率?\nA: 3Q25較低因與國稅局就費用認定達成共識、4Q25回復正常區間\n\nQ10: 非AI業務展望?\nA: LEO低軌衛星供應商市佔~60%並有機會提升、大型工控電源、遊戲機(含Sony)導入支撐成長", "rex_view": "正面因素:\n- 3Q25財務表現優異(營收/毛利率/EPS全線成長)\n- AI營收佔比上修至20%、2026超過20%\n- BBU產能2026已被訂滿、需求能見度高\n- CB發行120億顯示對長期成長有信心\n- 越南增資2億美元支應產能擴充\n- OCP展示完整系統整合能力\n- 朝「系統整合解決方案提供者」轉型\n\n需要關注:\n- OPM維持10%、未隨product mix改善而提升\n- 研發費用持續高企(YoY +52%)\n- 產能擴充能否跟上客戶需求\n- CB發行對股權稀釋影響\n- SST/DC-DC module仍在初期階段\n\n投資啟示:\n- 中信給予未評等(觀察)\n- AI佔比持續提升是明確趨勢\n- 產品組合改善但OPM未能同步提升\n- 2026營運成長無虞但獲利率需觀察", "follow_up": "- 4Q25實際營收與OPM表現\n- CB發行條件與轉換價格\n- 2026 CapEx規劃細節\n- BBU產能開出進度\n- 新CSP客戶導入時程\n- SST研發進度\n- DC-DC module樣品展示\n- 非AI業務成長動能", "tags": "#中信未評等 #AI佔比20% #BBU2026訂滿 #CB120億 #SST初期 #系統整合"}, {"id": 35, "operations": "【永豐投顧 張智皓 2025/10/08 - 買進、目標價210元】\n\n投資論點:\n1. 受惠伺服器電源及散熱內容價值提升、營運成長趨勢明確\n2. 2025年Power Rack及BBU營收貢獻相對較低\n3. 隨著新客戶加入及AI server新世代產品推出、營收將翻倍成長\n4. Power Rack及BBU將成為下一個成長動能\n5. 伺服器電源產品規格持續提升(12kW PSU, BBU, CDU等)\n6. 預估2026年AI相關營收佔比將超過25%\n7. 獲利能力將同步提升、預估2026年毛利率24.6%(+1.6pts YoY)\n8. 持續朝向系統整合商前進\n\n財務預估:\n9. 2025營收1664.3億元(YoY +21.4%)、毛利率23%(+0.8pts YoY)\n10. 2025稅後淨利149.4億元(YoY +25.1%)、稅後EPS 6.38元\n11. 2026營收1942.15億元(YoY +16.7%)、毛利率24.6%(+1.6pts YoY)\n12. 2026稅後淨利196.02億元(YoY +31.2%)、稅後EPS 8.37元", "strategy": "2H25雲端相關營收佔比將達20%:\n1. BBU產能目前已建置完成量產出貨\n2. 在新訂單加入下、預期BBU產品營收將佔4Q25的5-10%\n3. 下一世代電源產品如12kW PSU、50V Power Rack樣機將出貨\n4. AI營收(PSU, BBU, 散熱系統等)佔比將持續提升\n5. 消費性及光電半導體部門營運相對平淡\n6. 8月雲端及物聯網營收佔比達52%\n7. 預估3Q25營收455.46億元(+12.7% QoQ, +23.9% YoY)\n8. 預估3Q25毛利率24.2%(+2.1pts QoQ, +1.8pts YoY)\n9. 預估3Q25稅後淨利45.45億元(+44.1% QoQ, +34.1% YoY)、EPS 1.94元\n\n朝伺服器系統整合商邁進、2026營運成長無虞:\n10. AI伺服器在GB300仍採用5.5kW PSU、未來PSU規格將至少提升到12kW以上\n11. 採用化合物半導體亦將使產品價格提升\n12. HVDC方面、400V也有望於2026年出貨\n13. 2026成長動能聚焦於AI伺服器相關零組件規格提升及部件滲透率增加\n14. 整體AI資料中心電源產值成長", "qa": "(永豐為個股聚焦報告、無QA內容)\n\n但報告提及重點:\n1. 雖2025年Power Rack及BBU營收貢獻相對較低\n2. 然隨著新客戶加入及AI server新世代產品推出後、營收將翻倍成長\n3. 將成為下一個成長動能\n4. 在伺服器電源產品規格持續提升下\n5. 相關零組件(12kW PSU, BBU, CDU等)將陸續小量出貨\n6. 預估2026年AI相關營收有望超過25%\n7. 獲利能力將同步提升", "rex_view": "正面因素:\n- 永豐給予「買進」投資建議、目標價210元(25X 2026EPS)\n- 2026 AI營收佔比超過25%、成長動能明確\n- BBU產能2026訂滿、需求能見度高\n- 12kW PSU、Power Rack等新產品陸續出貨\n- 2026毛利率24.6%、獲利率同步提升\n- 朝系統整合商轉型、產品價值提升\n- 400V HVDC 2026出貨、化合物半導體應用\n- 整體AI資料中心電源產值成長\n\n需要關注:\n- 2025 Power Rack及BBU營收貢獻相對較低\n- 新產品量產時程能否如期\n- 競爭加劇風險\n- 產能擴充進度\n\n投資啟示:\n- 永豐給予最高評價: 買進、目標價210元\n- 評價以2026 EPS 8.37元計算、給予25倍本益比\n- 目前本益比約20倍、仍有25%上漲空間\n- 受惠AI資料中心電源產值成長\n- 2026營運成長無虞、獲利率同步提升", "follow_up": "- 3Q25實際營收與EPS表現\n- BBU在4Q25佔比能否達5-10%\n- 12kW PSU出貨進度\n- Power Rack樣機客戶反應\n- 400V HVDC 2026出貨時程\n- 新CSP客戶導入進度\n- 2026 AI營收佔比能否超過25%\n- 毛利率提升幅度\n- 系統整合能力建置進度", "tags": "#永豐買進 #目標價210 #2026AI佔比25% #BBU訂滿 #12kW #系統整合 #毛利率提升"}, {"id": 52, "operations": "【第一金投顧 蔡政杰 2024/05/07 - 區間操作、目標價103元】\n\n24Q1財務表現:\n1. 24Q1營收287.75億元(QoQ -22.04%, YoY -15.8%)\n2. 毛利率20.32%(低於預期21.75%)、受整體稼動率影響\n3. 營益率7.75%、AI賦能及數位化營運管理使營業費用控制得宜\n4. 稅後淨利23.87億元(QoQ -30.99%, YoY +1.48%)\n5. 稅後EPS 1.02元(低於預期1.18元)\n\n產品結構(24Q1):\n6. 資訊及消費性電子季減29%(佔比42%)\n7. 雲端及物聯網季減22%(佔比35%)\n8. 光電季減6%(佔比23%)\n9. AI表現成長強勁、較上季季增20%以上\n\n24Q2展望:\n10. 預估24Q2營收330.85億元(季增14.98%)\n11. 毛利率21.55%(營收規模擴大)\n12. 稅後EPS 1.31元", "strategy": "全年展望下修:\n1. 受消費性市場需求疲弱影響、三大事業營收展望同步下修\n2. 全年營收YoY從低個位數成長下修至中個位數衰退\n3. 季營收預估可望逐季成長\n4. AI Server電源產品高速成長展望不變\n5. 今年AI佔雲端運算12-15%(去年約7%)\n\n投資合作案:\n6. 投資日本電源大廠COSEL 19.99%股權(25.3億元)\n7. 第一: COSEL在高階工業電源市場具領導地位、光寶強處在大量消費性電源、雙方銷售通路互補\n8. 第二: 高階利基型電源市場(工業自動化/半導體設備/醫療/網通/運輸/新能源)市場規模4000億元\n9. 第三: 對COSEL投資可望來穩定收益\n\n次世代電源產品:\n10. 5.5KW AI Server PSU和機櫃式電源POWER SHELF 33KW已陸續交貨認證\n11. 櫃式氣冷(Side Car)以及In-row水冷產品解決方案已開發完畢\n12. 24H2將送樣北美CSP客戶認證\n13. 水冷產品最快將於25年開始貢獻營收", "qa": "(第一金為動態更新報告、無QA內容)\n\n但報告提及關鍵觀察點:\n1. 從上游來看、今年除了高端AI產品以外、消費性產品普遍持平\n2. 下半年消費力道優於上半年並不顯著\n3. 從目前相關供應鏈來看、訂單仍偏向急短單、能見度偏差\n4. 光寶科將受惠於整體AI資料中心電源產值的成長", "rex_view": "正面因素:\n- AI產品24Q1季增20%以上、成長動能明確\n- 投資COSEL拓展高階工業電源市場\n- 次世代電源產品已開發完畢、24H2送樣認證\n- 水冷產品25年有望開始貢獻營收\n- 季營收逐季成長趨勢不變\n\n需要關注:\n- 24Q1財務表現低於預期\n- 全年展望下修至中個位數衰退\n- 消費性市場需求疲弱\n- 訂單能見度偏差(急短單)\n- 毛利率受稼動率影響\n- AI獲利貢獻有限(雖然成長但基期低)\n\n投資啟示:\n- 第一金給予「區間操作」投資建議\n- 目標價103元(18X 2024EPS)\n- 考量公司獲利展望平淡、本益比17倍尚未偏低\n- 但考量高殖利率保護、仍有區間操作價值", "follow_up": "- 24Q2實際營收與EPS表現\n- 消費性市場復甦力道\n- 水冷產品北美CSP客戶認證進度\n- 25年水冷營收貢獻時程\n- COSEL合作案進展\n- AI產品成長幅度能否彌補消費性衰退\n- 稼動率改善進度\n- 訂單能見度變化", "tags": "#第一金區間操作 #目標價103 #全年下修 #COSEL合作 #水冷25年 #高殖利率"}], "timeline": [{"time": "4Q25", "event": "110kW PowerShelf量產", "type": "產品出貨", "importance": "⭐⭐⭐⭐", "impact": "新一代電源"}, {"time": "4Q25", "event": "400V PowerRack量產", "type": "技術突破", "importance": "⭐⭐⭐⭐⭐", "impact": "HVDC導入"}, {"time": "4Q25", "event": "新CDU散熱產品出貨", "type": "產品出貨", "importance": "⭐⭐⭐⭐", "impact": "散熱業務"}, {"time": "2026", "event": "AI營收佔比超過25%", "type": "業績里程碑", "importance": "⭐⭐⭐⭐⭐", "impact": "營收結構轉型"}, {"time": "2026", "event": "400V HVDC量產", "type": "技術突破", "importance": "⭐⭐⭐⭐⭐", "impact": "電源架構升級"}, {"time": "2027", "event": "800V HVDC導入", "type": "技術突破", "importance": "⭐⭐⭐⭐⭐", "impact": "配合Kyber平台"}]}, "2308": {"company_name": "台達電", "stock_code": "2308", "industry": "電源供應器", "status": "🔥重點追蹤", "report_count": 1, "latest_report": "2025/10/30", "rating": "未評等", "target_price": null, "memo": "AI Server電源23%、散熱11%、SST/BESS/FC發展", "basic_info": {"market": "上市", "industry_detail": "汽機車零組件,車用電池,UPS,車用電子,LED,LED照明產品,電源供應器,變壓器,無線充電,被動元件,晶片電阻,電感,其他電子零件,散熱風扇馬達,電子零件元件,散熱模組,顯示器,投影機,通訊設備,系統整合,軟體業,雲端科技,Internet技術與基礎設施,太陽能,PV Inverter,車用充電相關,...", "related_category": "ETF成份股–(0050) 元大台灣50,AI人工智慧–工業4.0,AI人工智慧,電源供應器", "industry_position": "全球最大的交換式電源供應器廠商", "price": 965.0, "price_change": -13.0, "price_change_pct": -1.33, "volume": 9673.0, "capital": 260.0, "market_cap": 25066.0, "years_established": 50.2, "years_listed": 36.9, "chairman": "鄭平", "ceo": "張訓海"}, "finance": {"revenue_3q": "1503.18億 (3Q25)", "revenue_yoy": "報告未提及", "revenue_qoq": "+21.2% QoQ", "gross_margin": "34.9%", "gross_margin_yoy": "-0.6ppt QoQ", "net_profit": "186.05億 (3Q25)", "net_profit_yoy": "+33.4% QoQ", "eps": "7.17 (3Q25)", "guidance_4q": "泰國3新廠年底啟用、2026資本支出設備佔65%"}, "products": {"product1": {"name": "Server Power", "performance": "23% (前三季AI佔比)、市占率高"}, "product2": {"name": "Cooling散熱", "performance": "11% (前三季AI佔比)、3Q25季增100%"}, "product3": {"name": "BESS/SST/FC", "performance": "BESS能效60%、FC 4Q26量產"}, "growth_driver": "Total Solution Provider、800V HVDC、SST", "outlook_2026": "泰國3新廠年底啟用、水冷台灣產能有限泰國中國補充"}, "reports": [{"id": 9, "date": "2025/10/30", "broker": "國泰證期", "analyst": "未提供", "type": "Call Memo", "importance": "⭐⭐⭐⭐⭐", "revenue_yoy": "+21.2% QoQ (3Q25)", "gross_margin": "34.9% (3Q25)", "eps": "7.17 (3Q25)"}, {"id": 22, "date": "2025/09/10", "broker": "元大投顧", "analyst": "陳旻暐", "type": "個股報告", "importance": "⭐⭐⭐⭐⭐", "revenue_yoy": "+24% (2026E)", "gross_margin": "報告未提及", "eps": "31.9 (2026E)"}, {"id": 37, "date": "2025/07/31", "broker": "國泰證期", "analyst": "未提供", "type": "Call Memo", "importance": "⭐⭐⭐⭐", "revenue_yoy": "+20% YoY (2Q25)", "gross_margin": "35.5% (2Q25)", "eps": "5.37 (2Q25)"}], "detail": [{"id": 37, "operations": "【國泰證期研究部 2025/07/31 - Call Memo】\n\n2Q25經營績效:\n1. 營收1240億元創歷史新高(QoQ +4%, YoY +20%)\n2. 毛利440億元創歷史新高(QoQ +17%, YoY +25%)\n3. 毛利率35.5%、產品組合優化、其中0.6個ppts來自存貨跌價損失迴轉\n4. 營運淨利187億元創歷史新高(YoY +44%, QoQ +33%)\n5. 營運淨利率(OPM)創歷史新高15.1%\n6. 稅後淨利139.5億元創歷史新高(YoY +40%, QoQ +36%)\n7. EPS 5.37元(QoQ +37%, YoY +40%)\n\n事業部表現:\n8. 基礎設施: 營收成長最快、獲利表現亮眼、上半年獲利比去年同期增長近9倍\n9. 電源零組件: 貢獻最多整體獲利、伺服器電源成長非常快\n10. AI資料中心電源供應器營收佔2Q25伺服器電源的22%\n11. 電動車: 2Q25維持小幅虧損、短期內難以顯著轉虧為盈、上半年無成長\n12. 自動化: 相對較為辛苦、獲利貢獻極少", "strategy": "毛利率提升關鍵與展望:\n1. AI產品組合優化、特別是高功率資料中心伺服器相關產品帶來健康毛利\n2. 整體毛利率相較去年僅增加約1個百分點(去年約34%)\n3. 因為今年只有AI相關業務有顯著成長、其他如電動車等毛利率不佳甚至略有下滑\n4. AI的高毛利抵銷了其他影響、使得整體毛利率差異不大\n5. 若下半年AI相關業務狀況良好、預計今年整體成長將主要依賴AI業務\n\n研發投入:\n6. 過去幾季研發投入比例約維持在營收的9.5%左右\n7. 公司希望研發比例能維持在9%\n8. 現有業務研發比例非常穩定約佔6%-7%\n9. 其他大部分研發投資都在新產品或新業務上\n10. 研發領域仍聚焦於資通訊科技、能源、電動車、電源零組件\n\nAI與液冷業務:\n11. 超大規模雲端服務供應商資本支出呈現上升趨勢、預計未來兩三年不會停止投資\n12. 針對AI資料中心電源供應器在2Q25伺服器電源營收佔比達22%\n13. 主要供應Power Shelf產品、同時關注下一代Power Rack(PRAC)\n14. PRAC是NVIDIA提出的下一代系統架構、預計2027年問世\n15. 液冷業務成長非常快、是基礎設施主要成長動能\n16. 產品包含板子上、機櫃級、液對氣(liquid-to-air)等方案\n17. 公司在資料中心內部「液對氣」散熱解決方案市佔率非常高\n18. 液對液散熱方案市場需求尚未大量啟動、發展速度可能不會那麼快\n19. 液冷產品本身毛利率高於公司平均水平", "qa": "Q1: 液冷系統供應鏈和製程?\nA: 複雜、許多大型關鍵零組件(如散熱鰭片)主要來自中國大陸。組裝模式: 主要零件從中國進口、前端組裝台灣、最終控制部分美國完成\n\nQ2: 關稅政策影響?\nA: 關稅政策每天都在變化、難以根據短期變化規劃產能、只能做小幅調整。長期策略是分散式製造、讓生產靠近市場需求、但需考量成本/技術人才/供應鏈、具規模生產據點建立需2-3年\n\nQ3: 泰國關稅影響?\nA: 如果泰國關稅維持36%不變、公司可能停止在泰國擴建液冷產能、將大幅降低成本效益。目前泰國仍有兩三個廠區啟用中、另有三個廠區在興建。客戶訂單模式實質改變預計需一季到半年時間\n\nQ4: 分散式製造策略?\nA: 自2015年起實施、長期目標讓生產靠近市場需求、但必須考量成本/技術人才/當地供應鏈可用性。建立具規模生產據點需2-3年、是較長期考量、不會受短期關稅波動影響", "rex_view": "正面因素:\n- 2Q25所有財務指標創歷史新高\n- AI電源佔伺服器電源22%、成長動能明確\n- 液冷業務上半年獲利增9倍、成長爆發\n- 液對氣散熱方案市佔率非常高\n- 液冷毛利率高於公司平均\n- CSP資本支出未來兩三年持續\n- Power Rack 2027問世、已提前布局\n- 分散式製造策略成熟(2015年起)\n\n需要關注:\n- 電動車業務虧損、短期難轉盈\n- 自動化業務獲利貢獻極少\n- AI高毛利抵銷其他業務衰退\n- 液對液散熱發展速度可能較慢\n- 中國供應鏈依賴度高(散熱鰭片等)\n- 泰國36%關稅可能停止液冷擴產\n- 關稅政策不確定性高\n- 分散式製造建置需2-3年\n\n投資啟示:\n- Call Memo無明確投資評等\n- 2Q25財務表現優異、所有指標創新高\n- AI+液冷雙引擎驅動成長\n- 液冷獲利爆發性成長(上半年增9倍)\n- 電動車/自動化拖累、但AI高毛利抵銷\n- Power Rack 2027商機、已提前布局\n- 關稅不確定性需持續關注", "follow_up": "- 3Q25/4Q25財務表現\n- AI電源佔比能否持續提升\n- 液冷業務成長持續性\n- 液對液散熱何時大量啟動\n- Power Rack 2027導入進度\n- 電動車業務何時轉盈\n- 泰國關稅政策變化\n- 泰國液冷產能擴建決策\n- 分散式製造新據點規劃\n- 中國供應鏈替代方案", "tags": "#國泰CallMemo #2Q25創新高 #AI電源22% #液冷獲利增9倍 #PowerRack2027 #泰國關稅 #分散式製造"}, {"id": 44, "operations": "【元大投顧 陳旻暐 2025/09/10 - 買進、目標價1050元】\n\n上修3Q/4Q25 EPS預估:\n1. 上修3Q25/4Q25 EPS 10%/14%至6.5/6.3元\n2. 上修3Q25/4Q25營收7%/8%至1,403億/1,419億元、季增13%/1%\n3. 主因: AI伺服器電源出貨加速、4Q25 12KW PSU小量出貨、電源規格提升\n4. 液冷散熱出貨加速、估單季液冷出貨皆近百億\n5. 毛利率估35.8%/35.2%、季增0.3個ppts/季減0.6個ppts、上修0.4/0.7個ppts\n\n2026/27年EPS躍升:\n6. 2026營收年增24%至6,499億元、上修11%\n7. 2027營收年增26%至8,212億元\n8. 主因: 電源集中化趨勢明確、1H26 CSP業者導入Power Rack架構\n9. 2H26客戶有望於Rubin及ASIC端小量導入HVDC高壓直流電源\n10. 2027年Rubin Ultra將大幅採用HVDC高壓直流電源架構", "strategy": "電源內容價值顯著提升:\n1. GB200電源內容價值: 5.9萬美元\n2. GB300電源內容價值: 8.3萬美元(+41%)\n3. Rubin電源內容價值: 16.2萬美元(+175%)\n4. Rubin Ultra電源內容價值: 46.4萬美元(+686%)\n5. 2026/27年受惠整體GPU TDP持續提升且台達電為少數具出貨實績廠商\n\nAI營收佔比大幅提升:\n6. 2025 AI相關營收: 1,151億元(佔總營收22%)、上修28%\n7. 2026 AI相關營收: 2,209億元(佔總營收34%)、上修39%\n8. 2027 AI相關營收: 3,678億元(佔總營收45%)\n9. EPS 2025/26/27年: 22.1/31.9/46.4元、年增63%/44%/46%、上修7%/23%/-\n\n產品組合持續優化:\n10. 高毛利產品營收佔比從2023年39%預估提升到2024/25/26/27年45%/48%/52%/58%\n11. 產品組合持續好轉、帶動獲利率提升\n12. 台達電處於電源產業龍頭地位\n13. EPS 2025-2027年估以CAGR 45%成長", "qa": "(元大為個股報告、無QA內容)\n\n但報告提及關鍵觀察點:\n1. 電源集中化與高壓直流供電架構趨勢明確\n2. 1H26 CSP業者將導入Power Rack架構\n3. 2H26客戶有望於Rubin及ASIC端小量導入HVDC\n4. 2027年Rubin Ultra將大幅採用HVDC\n5. 電源內容價值從GB200的5.9萬美元提升至Rubin Ultra的46.4萬美元(近8倍)\n6. 台達電為少數具HVDC出貨實績廠商\n7. 液冷散熱出貨提速且市占率提升", "rex_view": "正面因素:\n- 元大給予「買進」投資建議、目標價1050元(27X 2026-27平均EPS)\n- 電源架構升級趨勢明確(集中化+高壓化)\n- 電源內容價值爆發性成長(GB200→Rubin Ultra增7.9倍)\n- 2026/27 EPS分別年增44%/46%、CAGR 45%\n- AI營收佔比2025-2027從22%提升至45%\n- 高毛利產品佔比從39%(2023)提升至58%(2027)\n- 液冷散熱出貨加速、單季近百億\n- 12KW PSU 4Q25小量出貨、規格持續提升\n- Power Rack 1H26 CSP導入\n- HVDC 2H26小量導入、2027大幅採用\n- 龍頭地位穩固、少數具出貨實績\n\n需要關注:\n- 本益比27倍評價是否過高\n- Power Rack/HVDC導入時程能否如期\n- 競爭對手追趕進度\n- Rubin Ultra大量採用HVDC的不確定性\n- 客戶集中度風險\n\n投資啟示:\n- 元大給予最高評價: 買進、目標價1050元\n- 本次納入2027年EPS及提升本益比(前次為2026年EPS及26倍)\n- 理由: 整體產業趨勢明確\n- 電源架構從集中化走向高壓直流是明確趨勢\n- 台達電技術領先且具出貨實績\n- 2025-2027 EPS CAGR 45%、獲利高成長", "follow_up": "- 3Q25/4Q25實際EPS能否達6.5/6.3元\n- 12KW PSU 4Q25出貨進度\n- 液冷單季出貨能否達百億\n- Power Rack 1H26 CSP導入進度\n- HVDC 2H26小量導入時程\n- Rubin Ultra 2027大幅採用HVDC確定性\n- 2026/27營收能否達6,499/8,212億\n- AI營收佔比提升進度\n- 高毛利產品佔比能否如期提升至52%/58%\n- 競爭對手動態", "tags": "#元大買進 #目標價1050 #HVDC #PowerRack #RubinUltra #電源內容8倍增 #CAGR45%"}, {"id": 49, "operations": "【國泰證期研究部 2025/10/30 - Call Memo】\n\n3Q25經營績效:\n1. 營業收入1503.18億元(+21.2% QoQ)\n2. 營業毛利524.16億元(+19.0% QoQ)\n3. 毛利率34.9%(-0.6ppt QoQ)\n4. 營業費用267.07億元(+8.8% QoQ)\n5. 營業費用率18.4%(-2.1ppt QoQ)\n6. 營業利益248.08億元(+32.9% QoQ)\n7. 營業淨利率16.5%(+1.4ppt QoQ)\n8. 稅後淨利186.05億元(+33.4% QoQ)\n9. EPS 7.17元(+14.9% QoQ)\n\n費用與產能規劃:\n10. 從長遠來看、未來仍會持續在研發和銷售方面進行投資\n11. 以過去經驗來看、每年平均增加幅度約在15%到20%間\n12. 若營收持續擴大、營業費用率預計將會下降\n13. 資料中心相關產能: 泰國、美國都是滿產生產\n14. 泰國會有三個新廠開始使用、年底啟用\n15. 非美國部分則有機會在中國生產\n16. 資本支出明年設備資本支出會增加至65%", "strategy": "AI產品與展望:\n1. OCP展出SST的規劃與27年貢獻: 800V會先導入、SST客戶還需要觀察\n2. 二三季的GPM差異、主要是存貨損失迴轉的差異、兩季差異0.6%\n3. 營運動能主要觀察OPM還是NP: AI的OPM變動有可能在1~2%因為匯率/存貨/產品組合因素\n4. 費用還是持續投入尤其是RD與SALES、主要還是要觀察OPM的發展\n5. 在初期發展階段、因為現有市占率已高、未來市占率的成長將會開始走緩\n\n4Q與26年展望:\n6. 近期有交易美國Developer與operator剛簽約40B USD、代表市場還是很看好\n7. 未來還是要觀察到底哪些應用APP能夠有獲利的商模、才能夠支撐硬體的建設\n8. 目前看來都還樂觀\n\n水冷與散熱:\n9. 第三季水冷季增一倍\n10. 除了台灣生產是否有外購情形、泰國做水冷的規劃\n11. 台灣的水冷產能有限、泰國也會進來做、非美系的也可以在中國做\n12. 因為需要很多人工、中國的供應還是很重要", "qa": "Q1: 第三季會產生代付關稅的原因?\nA: 業務大多是ODM通常都是客人付款、有的走FOB以及DDP、到美國的營收主要95%還是由客戶負擔、但是遞延的情況還是會有\n\nQ2: BESS的進展?\nA: 產品販售BMS PCS是目前的狀況、電池芯還是外購為主\n\nQ3: AI佔比?客戶想要第二供應商?\nA: 前三季server power 23%, cooling 11%。有些客戶都希望拿total solution(solution provider)。一旦規格穩定了還是會找第二供應商\n\nQ4: 產能吃緊、考量關稅後、泰國生產還是比美國還有優勢?\nA: 美國有人力等成本考量、若是全自動產線才適合在美國、且模組進美國也有關稅挑戰、預期美國的產能逐步提升、兩年後才有大的新廠開出\n\nQ5: BESS與SST、微電網與FC的進展?\nA: BESS的能效轉換高有到60%、天然氣與燃煤只有35%、汽油引擎約35%、車用FC可達到40%。FC採用燃氣發電可達到60%、預期量產在4Q26", "rex_view": "正面因素:\n- 3Q25財務表現優異(營收/營業利益/EPS全線QoQ雙位數成長)\n- AI佔比明確: Server Power 23%、Cooling 11%\n- 水冷3Q25季增100%、成長動能強勁\n- 泰國3新廠年底啟用、產能持續擴充\n- 2026資本支出設備佔65%、顯示對成長有信心\n- Total Solution Provider定位、客戶黏著度高\n- 美國Developer/Operator簽約40B USD、市場需求強勁\n- FC 4Q26量產、能效60%、新成長動能\n- BESS能效60%優於傳統發電(35%)\n\n需要關注:\n- 毛利率QoQ -0.6ppt(存貨損失迴轉差異)\n- AI OPM變動1-2%受匯率/存貨/產品組合影響\n- 市占率已高、未來成長將走緩\n- 第二供應商競爭壓力\n- 美國產能擴充進度慢(兩年後才有大新廠)\n- 關稅挑戰(模組進美國)\n- 泰國生產vs美國生產成本考量\n- APP獲利商模不確定性\n\n投資啟示:\n- Call Memo無明確投資評等\n- AI業務佔比明確且持續成長\n- 從零組件供應商走向Total Solution Provider\n- 產能持續擴充、泰國/美國/中國多地布局\n- FC/BESS新業務4Q26量產、能效優勢明顯\n- 營運成長趨勢明確、但獲利率需持續觀察", "follow_up": "- 4Q25實際營收與EPS表現\n- 泰國3新廠啟用進度與產能貢獻\n- 2026資本支出規劃細節\n- 水冷產能擴充進度(台灣/泰國/中國)\n- AI佔比能否持續提升\n- 800V HVDC導入時程\n- SST客戶開發進度\n- FC 4Q26量產進度\n- BESS客戶開發與營收貢獻\n- 第二供應商競爭影響\n- 美國新廠建置時程\n- APP獲利商模發展", "tags": "#國泰CallMemo #AI佔比ServerPower23%Cooling11% #水冷季增100% #泰國3新廠 #FC4Q26 #BESS能效60% #TotalSolution #800V"}], "timeline": [{"time": "4Q25", "event": "泰國3新廠啟用", "type": "產能擴充", "importance": "⭐⭐⭐⭐⭐", "impact": "滿足AI需求"}, {"time": "2026", "event": "資本支出設備佔65%", "type": "投資擴張", "importance": "⭐⭐⭐⭐", "impact": "產能持續擴充"}, {"time": "2026", "event": "800V HVDC先導入", "type": "技術突破", "importance": "⭐⭐⭐⭐⭐", "impact": "電源架構升級"}, {"time": "4Q26", "event": "FC燃料電池量產", "type": "新產品", "importance": "⭐⭐⭐⭐", "impact": "能效達60%"}, {"time": "1H26", "event": "Power Rack導入", "type": "產品出貨", "importance": "⭐⭐⭐⭐⭐", "impact": "電源集中化"}, {"time": "2H26", "event": "HVDC小量導入", "type": "技術突破", "importance": "⭐⭐⭐⭐⭐", "impact": "Rubin/ASIC端"}, {"time": "2027", "event": "Rubin Ultra大量HVDC", "type": "技術突破", "importance": "⭐⭐⭐⭐⭐", "impact": "電源內容46.4萬美元"}]}}};
        class ResearchApp {
            constructor() {
                this.data = RESEARCH_DATA;
                this.currentCompany = null;
                this.init();
            }

            init() {
                this.updateStats();
                this.bindEvents();
            }

            bindEvents() {
                document.getElementById('searchBtn').addEventListener('click', () => this.handleSearch());
                document.getElementById('searchInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.handleSearch();
                });
            }

            updateStats() {
                document.getElementById('totalReports').textContent = this.data.stats.total_reports;
                document.getElementById('totalCompanies').textContent = this.data.stats.total_companies;
                document.getElementById('totalIndustries').textContent = this.data.stats.total_industries;
            }

            handleSearch() {
                const keyword = document.getElementById('searchInput').value.trim();
                const searchInput = document.getElementById('searchInput');
                
                if (!keyword) {
                    searchInput.style.borderColor = '#ef4444';
                    searchInput.placeholder = '❌ 請輸入股票代號或公司名稱';
                    setTimeout(() => {
                        searchInput.style.borderColor = '#e0e0e0';
                        searchInput.placeholder = '輸入股票代號或公司名稱 (如: 2330 或 台積電)';
                    }, 2000);
                    return;
                }

                let found = null;
                for (const [stockCode, company] of Object.entries(this.data.companies)) {
                    if (stockCode === keyword || company.company_name === keyword || 
                        company.company_name.includes(keyword)) {
                        found = stockCode;
                        break;
                    }
                }

                if (found) {
                    this.showCompany(found);
                } else {
                    searchInput.style.borderColor = '#ef4444';
                    searchInput.value = '';
                    searchInput.placeholder = '❌ 查無此公司 (測試版：智邦、勤誠、景碩、台積電等15家)';
                    setTimeout(() => {
                        searchInput.style.borderColor = '#e0e0e0';
                        searchInput.placeholder = '輸入股票代號或公司名稱 (如: 2330 或 台積電)';
                    }, 3000);
                }
            }

            showCompany(stockCode) {
                const company = this.data.companies[stockCode];
                this.currentCompany = company;
                document.getElementById('resultArea').style.display = 'block';
                this.renderCompanyCard(company);
                
                setTimeout(() => {
                    document.getElementById('resultArea').scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 100);
            }

            renderCompanyCard(company) {
                const card = document.getElementById('companyCard');
                
                const header = `
                    <div class="company-header">
                        <div>
                            <div class="company-name">${company.company_name}</div>
                            <div class="company-code">${company.stock_code} | ${company.industry}</div>
                        </div>
                        <div class="company-badge">${company.status}</div>
                    </div>
                `;

                const nav = `
                    <div class="dimension-nav">
                        <button class="dimension-btn active" data-dim="overview">📋 公司總覽</button>
                        <button class="dimension-btn" data-dim="finance">💰 財務表現</button>
                        <button class="dimension-btn" data-dim="products">📦 產品結構</button>
                        <button class="dimension-btn" data-dim="reports">📊 研究報告</button>
                        <button class="dimension-btn" data-dim="timeline">⏰ 關鍵時程</button>
                    </div>
                `;

                const content = this.renderOverview(company);
                card.innerHTML = header + nav + '<div id="content">' + content + '</div>';

                this.bindDimensionButtons(card, company);
            }

            bindDimensionButtons(card, company) {
                card.querySelectorAll('.dimension-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        card.querySelectorAll('.dimension-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        const dim = e.target.dataset.dim;
                        let html = '';
                        if (dim === 'overview') html = this.renderOverview(company);
                        else if (dim === 'finance') html = this.renderFinance(company);
                        else if (dim === 'products') html = this.renderProducts(company);
                        else if (dim === 'reports') html = this.renderReports(company);
                        else if (dim === 'timeline') html = this.renderTimeline(company);
                        document.getElementById('content').innerHTML = html;
                        
                        // 重新綁定報告卡片事件
                        if (dim === 'reports') {
                            this.bindReportCards();
                        }
                    });
                });
            }

            renderOverview(c) {
                // 公司基本資訊
                let html = '<div class="section-title">公司基本資料</div>';
                
                if (c.basic_info) {
                    const b = c.basic_info;
                    html += '<div class="data-grid">';
                    
                    if (b.market) html += '<div class="data-item"><div class="data-label">市場分類</div><div class="data-value">' + b.market + '</div></div>';
                    html += '<div class="data-item"><div class="data-label">產業分類</div><div class="data-value">' + c.industry + '</div></div>';
                    if (b.chairman) html += '<div class="data-item"><div class="data-label">董事長</div><div class="data-value">' + b.chairman + '</div></div>';
                    if (b.ceo) html += '<div class="data-item"><div class="data-label">總經理</div><div class="data-value">' + b.ceo + '</div></div>';
                    if (b.years_established) html += '<div class="data-item"><div class="data-label">成立年數</div><div class="data-value">' + b.years_established + ' 年</div></div>';
                    if (b.years_listed) html += '<div class="data-item"><div class="data-label">掛牌年數</div><div class="data-value">' + b.years_listed + ' 年</div></div>';
                    
                    html += '</div>';
                    
                    // 產業地位
                    if (b.industry_position) {
                        html += '<div class="content-card" style="margin-top: 15px; background: #fff8e1; border-left-color: #ffa726;">';
                        html += '<div style="font-weight: bold; color: #f57c00; margin-bottom: 8px;">產業地位</div>';
                        html += '<div style="font-size: 14px; color: #555;">' + this.escapeHtml(b.industry_position) + '</div>';
                        html += '</div>';
                    }
                    
                    // 產業細分與相關分類
                    if (b.industry_detail || b.related_category) {
                        html += '<div class="section-title">產業分類詳情</div>';
                        html += '<div class="content-card">';
                        
                        if (b.industry_detail) {
                            html += '<div style="margin-bottom: 12px;"><span style="font-weight: bold; color: #667eea;">產業細分：</span>';
                            html += '<span style="color: #555;">' + this.escapeHtml(b.industry_detail) + '</span></div>';
                        }
                        
                        if (b.related_category) {
                            html += '<div><span style="font-weight: bold; color: #667eea;">相關分類：</span>';
                            html += '<span style="color: #555;">' + this.escapeHtml(b.related_category) + '</span></div>';
                        }
                        
                        html += '</div>';
                    }
                }
                
                // 股價與交易資訊
                html += '<div class="section-title">股價與交易資訊</div>';
                html += '<div class="data-grid">';
                
                if (c.basic_info) {
                    const b = c.basic_info;
                    if (b.price) html += '<div class="data-item"><div class="data-label">股價</div><div class="data-value">' + b.price + ' 元</div></div>';
                    if (b.price_change) {
                        const changeClass = b.price_change > 0 ? 'positive' : (b.price_change < 0 ? 'negative' : '');
                        html += '<div class="data-item"><div class="data-label">漲跌</div><div class="data-value ' + changeClass + '">' + (b.price_change > 0 ? '+' : '') + b.price_change + '</div></div>';
                    }
                    if (b.price_change_pct) {
                        const changeClass = b.price_change_pct > 0 ? 'positive' : (b.price_change_pct < 0 ? 'negative' : '');
                        html += '<div class="data-item"><div class="data-label">漲跌幅</div><div class="data-value ' + changeClass + '">' + (b.price_change_pct > 0 ? '+' : '') + b.price_change_pct + '%</div></div>';
                    }
                    if (b.volume) html += '<div class="data-item"><div class="data-label">成交張數</div><div class="data-value">' + b.volume + ' 張</div></div>';
                    if (b.capital) html += '<div class="data-item"><div class="data-label">股本</div><div class="data-value">' + b.capital + ' 億</div></div>';
                    if (b.market_cap) html += '<div class="data-item"><div class="data-label">市值</div><div class="data-value">' + b.market_cap + ' 億</div></div>';
                }
                
                html += '</div>';
                
                // 追蹤狀態
                html += '<div class="section-title">追蹤狀態</div>';
                html += '<div class="data-grid">';
                html += '<div class="data-item"><div class="data-label">追蹤狀態</div><div class="data-value">' + c.status + '</div></div>';
                html += '<div class="data-item"><div class="data-label">報告數量</div><div class="data-value">' + c.report_count + ' 篇</div></div>';
                html += '<div class="data-item"><div class="data-label">最新報告</div><div class="data-value">' + (c.latest_report || '-') + '</div></div>';
                html += '<div class="data-item"><div class="data-label">投資評等</div><div class="data-value">' + (c.rating || '-') + '</div></div>';
                html += '<div class="data-item"><div class="data-label">目標價</div><div class="data-value">' + (c.target_price || '-') + '</div></div>';
                html += '</div>';
                
                // 重點摘要
                if (c.memo) {
                    html += '<div class="section-title">重點摘要</div>';
                    html += '<div class="content-card">' + this.formatTextWithBullets(c.memo) + '</div>';
                }
                
                // 3Q25 財務快覽
                if (c.finance && Object.keys(c.finance).length > 0) {
                    const f = c.finance;
                    html += '<div class="section-title">3Q25 財務快覽</div>';
                    html += '<div class="data-grid">';
                    html += '<div class="data-item"><div class="data-label">營收</div><div class="data-value">' + (f.revenue_3q || '-') + '</div></div>';
                    html += '<div class="data-item"><div class="data-label">營收YoY</div><div class="data-value ' + this.getChangeClass(f.revenue_yoy) + '">' + (f.revenue_yoy || '-') + '</div></div>';
                    html += '<div class="data-item"><div class="data-label">毛利率</div><div class="data-value">' + (f.gross_margin || '-') + '</div></div>';
                    html += '<div class="data-item"><div class="data-label">EPS</div><div class="data-value">' + (f.eps || '-') + '</div></div>';
                    html += '<div class="data-item"><div class="data-label">稅後淨利</div><div class="data-value">' + (f.net_profit || '-') + '</div></div>';
                    html += '<div class="data-item"><div class="data-label">淨利YoY</div><div class="data-value ' + this.getChangeClass(f.net_profit_yoy) + '">' + (f.net_profit_yoy || '-') + '</div></div>';
                    html += '</div>';
                }
                
                // 主要產品線
                if (c.products && Object.keys(c.products).length > 0) {
                    const p = c.products;
                    html += '<div class="section-title">主要產品線</div>';
                    html += '<div class="data-grid">';
                    
                    if (p.product1 && p.product1.name) {
                        html += '<div class="data-item"><div class="data-label">' + this.escapeHtml(p.product1.name) + '</div>';
                        html += '<div class="data-value" style="font-size: 13px;">' + this.escapeHtml(p.product1.performance) + '</div></div>';
                    }
                    if (p.product2 && p.product2.name) {
                        html += '<div class="data-item"><div class="data-label">' + this.escapeHtml(p.product2.name) + '</div>';
                        html += '<div class="data-value" style="font-size: 13px;">' + this.escapeHtml(p.product2.performance) + '</div></div>';
                    }
                    if (p.product3 && p.product3.name) {
                        html += '<div class="data-item"><div class="data-label">' + this.escapeHtml(p.product3.name) + '</div>';
                        html += '<div class="data-value" style="font-size: 13px;">' + this.escapeHtml(p.product3.performance) + '</div></div>';
                    }
                    
                    html += '</div>';
                    
                    // 關鍵成長動能
                    if (p.growth_driver) {
                        html += '<div class="section-title">關鍵成長動能</div>';
                        html += '<div class="content-card">' + this.formatTextWithBullets(p.growth_driver) + '</div>';
                    }
                    
                    // 2026展望
                    if (p.outlook_2026) {
                        html += '<div class="section-title">2026 展望</div>';
                        html += '<div class="content-card">' + this.formatTextWithBullets(p.outlook_2026) + '</div>';
                    }
                }
                
                // 近期關鍵時程
                if (c.timeline && c.timeline.length > 0) {
                    html += '<div class="section-title">近期關鍵時程</div>';
                    html += '<div class="content-card">';
                    c.timeline.slice(0, 3).forEach(event => {
                        html += '<div style="margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px dashed #e0e0e0;">';
                        html += '<div style="color: #667eea; font-weight: bold; margin-bottom: 4px;">' + event.time + ' ' + (event.importance || '') + '</div>';
                        html += '<div style="font-size: 14px; color: #555;">' + event.event + '</div>';
                        if (event.impact) {
                            html += '<div style="font-size: 12px; color: #999; margin-top: 4px;">影響: ' + event.impact + '</div>';
                        }
                        html += '</div>';
                    });
                    if (c.timeline.length > 3) {
                        html += '<div style="text-align: center; color: #999; font-size: 12px;">查看「⏰ 關鍵時程」了解更多...</div>';
                    }
                    html += '</div>';
                }
                
                return html;
            }

            renderFinance(c) {
                if (!c.finance || Object.keys(c.finance).length === 0) {
                    return '<div class="empty-state"><div class="empty-icon">📊</div>暫無財務數據</div>';
                }
                
                const f = c.finance;
                let html = '<div class="section-title">3Q25 財務表現</div>';
                html += '<div class="data-grid">';
                html += '<div class="data-item"><div class="data-label">營收</div><div class="data-value">' + (f.revenue_3q || '-') + '</div></div>';
                html += '<div class="data-item"><div class="data-label">營收YoY</div><div class="data-value ' + this.getChangeClass(f.revenue_yoy) + '">' + (f.revenue_yoy || '-') + '</div></div>';
                html += '<div class="data-item"><div class="data-label">營收QoQ</div><div class="data-value ' + this.getChangeClass(f.revenue_qoq) + '">' + (f.revenue_qoq || '-') + '</div></div>';
                html += '<div class="data-item"><div class="data-label">毛利率</div><div class="data-value">' + (f.gross_margin || '-') + '</div></div>';
                html += '<div class="data-item"><div class="data-label">毛利率YoY</div><div class="data-value ' + this.getChangeClass(f.gross_margin_yoy) + '">' + (f.gross_margin_yoy || '-') + '</div></div>';
                html += '<div class="data-item"><div class="data-label">稅後淨利</div><div class="data-value">' + (f.net_profit || '-') + '</div></div>';
                html += '<div class="data-item"><div class="data-label">淨利YoY</div><div class="data-value ' + this.getChangeClass(f.net_profit_yoy) + '">' + (f.net_profit_yoy || '-') + '</div></div>';
                html += '<div class="data-item"><div class="data-label">EPS</div><div class="data-value">' + (f.eps || '-') + '</div></div>';
                html += '</div>';
                
                if (f.guidance_4q) {
                    html += '<div class="section-title">4Q25 指引</div>';
                    html += '<div class="content-card"><div class="content-text">' + this.escapeHtml(f.guidance_4q) + '</div></div>';
                }
                
                return html;
            }

            renderProducts(c) {
                if (!c.products || Object.keys(c.products).length === 0) {
                    return '<div class="empty-state"><div class="empty-icon">📦</div>暫無產品資訊</div>';
                }
                
                const p = c.products;
                let html = '<div class="section-title">主要產品線</div>';
                
                html += '<table class="product-table">';
                html += '<tr><th>產品</th><th>表現</th></tr>';
                
                if (p.product1 && p.product1.name) {
                    html += '<tr><td>' + this.escapeHtml(p.product1.name) + '</td><td>' + this.escapeHtml(p.product1.performance) + '</td></tr>';
                }
                if (p.product2 && p.product2.name) {
                    html += '<tr><td>' + this.escapeHtml(p.product2.name) + '</td><td>' + this.escapeHtml(p.product2.performance) + '</td></tr>';
                }
                if (p.product3 && p.product3.name) {
                    html += '<tr><td>' + this.escapeHtml(p.product3.name) + '</td><td>' + this.escapeHtml(p.product3.performance) + '</td></tr>';
                }
                
                html += '</table>';
                
                if (p.growth_driver) {
                    html += '<div class="section-title">關鍵成長動能</div>';
                    html += '<div class="content-card"><div class="content-text">' + this.escapeHtml(p.growth_driver) + '</div></div>';
                }
                
                if (p.outlook_2026) {
                    html += '<div class="section-title">2026 展望</div>';
                    html += '<div class="content-card"><div class="content-text">' + this.escapeHtml(p.outlook_2026) + '</div></div>';
                }
                
                return html;
            }

            renderReports(c) {
                if (!c.reports || c.reports.length === 0) {
                    return '<div class="empty-state"><div class="empty-icon">📭</div>暫無報告資料</div>';
                }
                
                let html = '<div class="section-title">共 ' + c.reports.length + ' 篇研究報告</div>';
                
                c.reports.forEach((r, idx) => {
                    const detail = c.detail.find(d => d.id === r.id);
                    
                    html += '<div class="report-card" data-report-id="' + r.id + '">';
                    html += '<div class="report-header">';
                    html += '<div><div class="report-date">' + r.date + '</div>';
                    html += '<div class="report-broker">' + r.broker + (r.analyst ? ' - ' + r.analyst : '') + '</div></div>';
                    html += '<div class="report-type">' + r.type + '</div>';
                    html += '</div>';
                    
                    html += '<div class="report-summary">';
                    html += '<div class="data-item"><div class="data-label">營收YoY</div><div class="data-value">' + (r.revenue_yoy || '-') + '</div></div>';
                    html += '<div class="data-item"><div class="data-label">毛利率</div><div class="data-value">' + (r.gross_margin || '-') + '</div></div>';
                    html += '<div class="data-item"><div class="data-label">EPS</div><div class="data-value">' + (r.eps || '-') + '</div></div>';
                    html += '</div>';
                    
                    if (detail) {
                        html += '<div class="report-detail">';
                        
                        if (detail.operations) {
                            html += '<div class="section-title">營運重點</div>';
                            html += '<div class="content-card">' + this.formatTextWithBullets(detail.operations) + '</div>';
                        }
                        
                        if (detail.strategy) {
                            html += '<div class="section-title">策略方向</div>';
                            html += '<div class="content-card">' + this.formatTextWithBullets(detail.strategy) + '</div>';
                        }
                        
                        if (detail.qa && detail.qa !== '報告未提供QA內容(個股報告非法說會紀錄)') {
                            html += '<div class="section-title">重要QA摘要</div>';
                            html += '<div class="qa-container">' + this.formatQA(detail.qa) + '</div>';
                        }
                        
                        if (detail.rex_view) {
                            html += '<div class="section-title">Rex觀察</div>';
                            html += '<div class="content-card" style="background: #fff8e1; border-left-color: #ffa726;">';
                            html += this.formatTextWithBullets(detail.rex_view);
                            html += '</div>';
                        }
                        
                        if (detail.follow_up) {
                            html += '<div class="section-title">後續追蹤</div>';
                            html += '<div class="content-card" style="background: #e8f5e9; border-left-color: #66bb6a;">';
                            html += this.formatTextWithBullets(detail.follow_up);
                            html += '</div>';
                        }
                        
                        if (detail.tags) {
                            const tags = detail.tags.split('#').filter(t => t.trim()).map(t => t.trim());
                            if (tags.length > 0) {
                                html += '<div class="tags">';
                                tags.forEach(tag => {
                                    html += '<div class="tag">#' + this.escapeHtml(tag) + '</div>';
                                });
                                html += '</div>';
                            }
                        }
                        
                        html += '</div>';
                    }
                    
                    html += '</div>';
                });
                
                return html;
            }

            renderTimeline(c) {
                if (!c.timeline || c.timeline.length === 0) {
                    return '<div class="empty-state"><div class="empty-icon">⏰</div>暫無時程資訊</div>';
                }
                
                let html = '<div class="section-title">關鍵事件追蹤</div>';
                html += '<div class="timeline">';
                
                c.timeline.forEach(event => {
                    html += '<div class="timeline-item">';
                    html += '<div class="timeline-time">' + event.time + ' ' + (event.importance || '') + '</div>';
                    html += '<div class="timeline-event"><strong>' + event.type + ':</strong> ' + event.event + '</div>';
                    if (event.impact) {
                        html += '<div class="timeline-impact">預期影響: ' + event.impact + '</div>';
                    }
                    html += '</div>';
                });
                
                html += '</div>';
                return html;
            }

            bindReportCards() {
                document.querySelectorAll('.report-card').forEach(card => {
                    // 整張卡片都可以點擊展開
                    card.addEventListener('click', (e) => {
                        card.classList.toggle('expanded');
                    });
                });
            }

            formatTextWithBullets(text) {
                let formatted = text;
                
                // 處理數字編號 (1. 2. 3. 等) → 轉成 •
                if (/^\d+\. /m.test(formatted)) {
                    formatted = formatted.replace(/^(\d+)\. (.+?)$/gm, '<div class="content-list-item">$2</div>');
                    formatted = '<div class="content-list">' + formatted + '</div>';
                    return formatted;
                }
                
                // 處理頓號分隔（、）→ 轉成 •
                if (formatted.includes('、')) {
                    const parts = formatted.split('、').filter(p => p.trim());
                    if (parts.length > 1) {
                        formatted = '<div class="content-list">' + 
                            parts.map(p => '<div class="content-list-item">' + this.escapeHtml(p.trim()) + '</div>').join('') +
                            '</div>';
                        return formatted;
                    }
                }
                
                // 保持破折號（-）原樣，不做轉換
                return '<div class="content-text">' + this.escapeHtml(text) + '</div>';
            }

            parseQA(qaText) {
                const qaItems = [];
                
                if (qaText.includes('Q:') && qaText.includes('A:')) {
                    const parts = qaText.split(/;(?=Q:)/);
                    parts.forEach(part => {
                        const match = part.match(/Q:(.+?)\?A:(.+)/);
                        if (match) {
                            qaItems.push({
                                question: match[1].trim(),
                                answer: match[2].trim().replace(/;$/, '')
                            });
                        }
                    });
                }
                
                if (qaItems.length === 0 && (qaText.includes('Q1：') || qaText.includes('Q1:'))) {
                    const parts = qaText.split(/\n\n+/);
                    parts.forEach(part => {
                        const match = part.match(/Q\d*[：:](.*?)A[：:](.*)/s);
                        if (match) {
                            qaItems.push({
                                question: match[1].trim(),
                                answer: match[2].trim()
                            });
                        }
                    });
                }
                
                return qaItems;
            }

            formatQA(qaText) {
                const items = this.parseQA(qaText);
                
                if (items.length === 0) {
                    return '<div class="content-text">' + this.escapeHtml(qaText) + '</div>';
                }
                
                return items.map(item => `
                    <div class="qa-item">
                        <div class="qa-question">${this.escapeHtml(item.question)}</div>
                        <div class="qa-answer">${this.escapeHtml(item.answer)}</div>
                    </div>
                `).join('');
            }

            getChangeClass(value) {
                if (!value) return '';
                if (value.includes('+')) return 'positive';
                if (value.includes('-')) return 'negative';
                return '';
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        new ResearchApp();
    </script>
</body>
</html>
