<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rexå¤§å”å°è‚¡AIæ™ºèƒ½æŸ¥è©¢ç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .error-box {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .error-box h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .error-box p {
            color: #856404;
            line-height: 1.6;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-card h3 {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 10px;
        }

        .stat-card p {
            color: #666;
            font-size: 1.1em;
        }

        .search-section {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .search-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid #f0f0f0;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 15px 30px;
            border: none;
            background: none;
            color: #666;
            font-size: 1.1em;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab-button.active {
            color: #667eea;
            border-bottom-color: #667eea;
            font-weight: bold;
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1.1em;
        }

        .search-button {
            padding: 15px 40px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
        }

        .quick-links {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .quick-link {
            padding: 8px 15px;
            background: #f0f0f0;
            border: none;
            border-radius: 20px;
            cursor: pointer;
        }

        .results-section {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            min-height: 400px;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: #666;
            font-size: 1.2em;
        }

        .result-card {
            border: 2px solid #f0f0f0;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .result-title {
            font-size: 1.8em;
            color: #333;
            font-weight: bold;
        }

        .result-badge {
            padding: 8px 20px;
            background: #667eea;
            color: white;
            border-radius: 20px;
        }

        .result-section {
            margin-bottom: 25px;
        }

        .result-section h3 {
            color: #667eea;
            font-size: 1.3em;
            margin-bottom: 15px;
            padding-left: 15px;
            border-left: 4px solid #667eea;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .result-item {
            padding: 15px;
            background: #f9f9f9;
            border-radius: 10px;
        }

        .result-label {
            color: #888;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .result-value {
            color: #333;
            font-size: 1.1em;
            font-weight: bold;
        }

        .debug-info {
            background: #f0f0f0;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            .search-box {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– Rexå¤§å”å°è‚¡AIæ™ºèƒ½æŸ¥è©¢ç³»çµ±</h1>
            <p>æ•´åˆç”¢æ¥­ç ”ç©¶ã€åˆ¸å•†å ±å‘Šã€å¯è½‰å‚µä¸‰å¤§è³‡æ–™åº«</p>
        </div>

        <div class="error-box" id="error-message" style="display:none;">
            <h3>âš ï¸ è³‡æ–™è¼‰å…¥å¤±æ•—</h3>
            <p id="error-text"></p>
        </div>

        <div class="stats">
            <div class="stat-card">
                <h3 id="stat-companies">è¼‰å…¥ä¸­...</h3>
                <p>ä¸Šå¸‚æ«ƒå…¬å¸</p>
            </div>
            <div class="stat-card">
                <h3 id="stat-reports">è¼‰å…¥ä¸­...</h3>
                <p>åˆ¸å•†ç ”ç©¶å ±å‘Š</p>
            </div>
            <div class="stat-card">
                <h3 id="stat-cb">è¼‰å…¥ä¸­...</h3>
                <p>å¯è½‰å‚µæª”æ•¸</p>
            </div>
            <div class="stat-card">
                <h3 id="stat-market">è¼‰å…¥ä¸­...</h3>
                <p>CBå¸‚å ´è¡Œæƒ…</p>
            </div>
        </div>

        <div class="search-section">
            <div class="search-tabs">
                <button class="tab-button active" onclick="switchTab('company', event)">
                    ğŸ“Š å…¬å¸æŸ¥è©¢
                </button>
                <button class="tab-button" onclick="switchTab('cb', event)">
                    ğŸ’° CBæŸ¥è©¢
                </button>
                <button class="tab-button" onclick="switchTab('industry', event)">
                    ğŸ“ˆ ç”¢æ¥­åˆ†æ
                </button>
                <button class="tab-button" onclick="switchTab('scan', event)">
                    ğŸ¯ æ©Ÿæœƒæƒæ
                </button>
            </div>

            <div id="tab-company" class="tab-content">
                <div class="search-box">
                    <input type="text" 
                           id="company-input" 
                           class="search-input" 
                           placeholder="è¼¸å…¥è‚¡ç¥¨ä»£è™Ÿæˆ–å…¬å¸åç¨± (ä¾‹å¦‚: 2330 æˆ– å°ç©é›»)"
                           onkeypress="if(event.key==='Enter') searchCompany()">
                    <button class="search-button" onclick="searchCompany()">
                        ğŸ” æŸ¥è©¢
                    </button>
                </div>
                <div class="quick-links">
                    <span style="color: #666; margin-right: 10px;">å¿«é€ŸæŸ¥è©¢ï¼š</span>
                    <button class="quick-link" onclick="quickSearch('2330')">å°ç©é›»</button>
                    <button class="quick-link" onclick="quickSearch('2317')">é´»æµ·</button>
                    <button class="quick-link" onclick="quickSearch('2454')">è¯ç™¼ç§‘</button>
                    <button class="quick-link" onclick="quickSearch('2412')">ä¸­è¯é›»</button>
                    <button class="quick-link" onclick="quickSearch('2882')">åœ‹æ³°é‡‘</button>
                </div>
            </div>
        </div>

        <div class="results-section" id="results">
            <div class="loading">
                <p>ğŸ”„ æ­£åœ¨è¼‰å…¥è³‡æ–™...</p>
                <div id="debug-info" class="debug-info" style="margin-top: 20px;"></div>
            </div>
        </div>
    </div>

    <script>
        let stockData = null;
        
        // é™¤éŒ¯è¨Šæ¯
        function addDebugInfo(message) {
            const debugDiv = document.getElementById('debug-info');
            if (debugDiv) {
                const time = new Date().toLocaleTimeString();
                debugDiv.innerHTML += `[${time}] ${message}<br>`;
            }
            console.log(message);
        }

        // è¼‰å…¥è³‡æ–™ - å°ˆé–€é‡å° GitHub Pages å„ªåŒ–
        async function loadData() {
            addDebugInfo('é–‹å§‹è¼‰å…¥è³‡æ–™...');
            
            try {
                // GitHub Pages çš„æ­£ç¢ºè·¯å¾‘
                const jsonPath = './stock_ai_data_full.json';
                addDebugInfo(`å˜—è©¦è¼‰å…¥: ${jsonPath}`);
                
                const response = await fetch(jsonPath);
                addDebugInfo(`å›æ‡‰ç‹€æ…‹: ${response.status} ${response.statusText}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                stockData = await response.json();
                addDebugInfo('âœ… JSON è§£ææˆåŠŸï¼');
                
                // æ›´æ–°çµ±è¨ˆæ•¸å­—
                document.getElementById('stat-companies').textContent = stockData.industry_database.length.toLocaleString();
                document.getElementById('stat-reports').textContent = stockData.research_reports.length;
                document.getElementById('stat-cb').textContent = stockData.cb_basic.length.toLocaleString();
                document.getElementById('stat-market').textContent = stockData.cb_market.length;
                
                addDebugInfo(`âœ… è³‡æ–™è¼‰å…¥å®Œæˆï¼å…¬å¸æ•¸: ${stockData.industry_database.length}`);
                
                // éš±è—è¼‰å…¥è¨Šæ¯
                document.getElementById('results').innerHTML = '<div class="loading">âœ… è³‡æ–™è¼‰å…¥æˆåŠŸï¼è«‹è¼¸å…¥æŸ¥è©¢æ¢ä»¶</div>';
                
                // éš±è—éŒ¯èª¤è¨Šæ¯
                document.getElementById('error-message').style.display = 'none';
                
            } catch (error) {
                addDebugInfo(`âŒ éŒ¯èª¤: ${error.message}`);
                console.error('è³‡æ–™è¼‰å…¥å¤±æ•—:', error);
                showError(error);
            }
        }

        function showError(error) {
            const errorBox = document.getElementById('error-message');
            const errorText = document.getElementById('error-text');
            
            errorText.innerHTML = `
                <strong>è¼‰å…¥å¤±æ•—ï¼éŒ¯èª¤è¨Šæ¯ï¼š</strong><br>
                ${error.message}<br><br>
                
                <strong>è«‹ç¢ºèªï¼š</strong><br>
                1. stock_ai_data_full.json æª”æ¡ˆå·²ä¸Šå‚³åˆ° GitHub<br>
                2. æª”æ¡ˆèˆ‡ index.html åœ¨åŒä¸€ç›®éŒ„<br>
                3. æª”æ¡ˆåç¨±å®Œå…¨æ­£ç¢ºï¼ˆå€åˆ†å¤§å°å¯«ï¼‰<br>
                4. GitHub Pages å·²å•Ÿç”¨ä¸¦éƒ¨ç½²å®Œæˆ<br><br>
                
                <strong>æ¸¬è©¦é€£çµï¼š</strong><br>
                <a href="./stock_ai_data_full.json" target="_blank">é»æ­¤æ¸¬è©¦ JSON æª”æ¡ˆæ˜¯å¦å¯è¨ªå•</a>
            `;
            
            errorBox.style.display = 'block';
            
            // æ›´æ–°çµ±è¨ˆç‚ºéŒ¯èª¤è¨Šæ¯
            document.getElementById('stat-companies').textContent = 'éŒ¯èª¤';
            document.getElementById('stat-reports').textContent = 'éŒ¯èª¤';
            document.getElementById('stat-cb').textContent = 'éŒ¯èª¤';
            document.getElementById('stat-market').textContent = 'éŒ¯èª¤';
            
            document.getElementById('results').innerHTML = '<div class="loading">âŒ è³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹æŸ¥çœ‹ä¸Šæ–¹éŒ¯èª¤è¨Šæ¯</div>';
        }

        function switchTab(tab, event) {
            // ç§»é™¤æ‰€æœ‰ active é¡åˆ¥
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            // æ·»åŠ åˆ°é»æ“Šçš„æŒ‰éˆ•
            event.target.classList.add('active');
        }

        function quickSearch(code) {
            document.getElementById('company-input').value = code;
            searchCompany();
        }

        function searchCompany() {
            if (!stockData) {
                alert('è³‡æ–™å°šæœªè¼‰å…¥ï¼Œè«‹ç¨å€™æˆ–é‡æ–°æ•´ç†é é¢');
                return;
            }

            const input = document.getElementById('company-input').value.trim();
            if (!input) {
                alert('è«‹è¼¸å…¥è‚¡ç¥¨ä»£è™Ÿæˆ–å…¬å¸åç¨±');
                return;
            }

            document.getElementById('results').innerHTML = '<div class="loading">ğŸ” æŸ¥è©¢ä¸­...</div>';

            // æœå°‹å…¬å¸
            let company = null;
            for (let c of stockData.industry_database) {
                if (c['ä»£è™Ÿ'] == input || (c['å…¬å¸åç¨±'] && c['å…¬å¸åç¨±'].includes(input))) {
                    company = c;
                    break;
                }
            }

            if (!company) {
                document.getElementById('results').innerHTML = `<div class="loading">âŒ æ‰¾ä¸åˆ°ã€Œ${input}ã€ç›¸é—œå…¬å¸</div>`;
                return;
            }

            // æŸ¥è©¢ç›¸é—œè³‡æ–™
            const stockCode = company['ä»£è™Ÿ'];
            const finance = stockData.financial_data.find(f => f['è‚¡è™Ÿ'] == stockCode);
            const product = stockData.product_analysis.find(p => p['è‚¡è™Ÿ'] == stockCode);
            const reports = stockData.research_reports.filter(r => r['è‚¡è™Ÿ'] == stockCode);
            const cbs = stockData.cb_basic.filter(cb => cb['è‚¡ç¥¨ä»£è™Ÿ'] == stockCode);

            displayResult(company, finance, product, reports, cbs);
        }

        function displayResult(company, finance, product, reports, cbs) {
            let html = `
                <div class="result-card">
                    <div class="result-header">
                        <div class="result-title">${company['å…¬å¸åç¨±']} (${company['ä»£è™Ÿ']})</div>
                        <div class="result-badge">${company['ç”¢æ¥­åˆ†é¡']}</div>
                    </div>

                    <div class="result-section">
                        <h3>ğŸ“‹ åŸºæœ¬è³‡æ–™</h3>
                        <div class="result-grid">
                            <div class="result-item">
                                <div class="result-label">ç”¢æ¥­ç´°åˆ†</div>
                                <div class="result-value">${company['ç”¢æ¥­ç´°åˆ†'] || 'N/A'}</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">è‚¡æœ¬(å„„)</div>
                                <div class="result-value">${company['è‚¡æœ¬(å„„)'] || 'N/A'}</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">å¸‚å€¼(å„„)</div>
                                <div class="result-value">${company['å¸‚å€¼(å„„)'] || 'N/A'}</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">è‘£äº‹é•·</div>
                                <div class="result-value">${company['è‘£äº‹é•·'] || 'N/A'}</div>
                            </div>
                        </div>
                        ${company['ç”¢æ¥­åœ°ä½èªªæ˜'] ? `<div style="margin-top: 15px; padding: 15px; background: #f9f9f9; border-radius: 10px;"><strong>ç”¢æ¥­åœ°ä½ï¼š</strong>${company['ç”¢æ¥­åœ°ä½èªªæ˜']}</div>` : ''}
                    </div>
            `;

            if (finance) {
                html += `
                    <div class="result-section">
                        <h3>ğŸ’° è²¡å‹™è¡¨ç¾</h3>
                        <div class="result-grid">
                            <div class="result-item">
                                <div class="result-label">ç‡Ÿæ”¶YoY</div>
                                <div class="result-value">${finance['ç‡Ÿæ”¶YoY'] || 'N/A'}</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">æ¯›åˆ©ç‡</div>
                                <div class="result-value">${finance['æ¯›åˆ©ç‡'] || 'N/A'}</div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">EPS</div>
                                <div class="result-value">${finance['EPS'] || 'N/A'}</div>
                            </div>
                        </div>
                    </div>
                `;
            }

            if (reports && reports.length > 0) {
                html += `
                    <div class="result-section">
                        <h3>ğŸ“Š åˆ¸å•†ç ”ç©¶å ±å‘Š (${reports.length}ç¯‡)</h3>
                `;
                reports.slice(0, 5).forEach(report => {
                    html += `
                        <div style="padding: 15px; background: #f9f9f9; border-radius: 10px; margin-bottom: 10px;">
                            <strong>${report['åˆ¸å•†']}</strong> - ${report['å ±å‘Šé¡å‹']}<br>
                            <span style="color: #888;">${report['æ—¥æœŸ']}</span>
                        </div>
                    `;
                });
                html += `</div>`;
            }

            if (cbs && cbs.length > 0) {
                html += `
                    <div class="result-section">
                        <h3>ğŸ’ å¯è½‰å‚µ (${cbs.length}æª”)</h3>
                `;
                cbs.forEach(cb => {
                    html += `
                        <div style="padding: 15px; background: #f9f9f9; border-radius: 10px; margin-bottom: 10px;">
                            <strong>${cb['åç¨±']}</strong> (${cb['CBä»£è™Ÿ']})<br>
                            è½‰æ›åƒ¹: ${cb['è½‰æ›åƒ¹æ ¼']} | è¦æ¨¡: ${cb['ç™¼è¡Œè¦æ¨¡']}å„„
                        </div>
                    `;
                });
                html += `</div>`;
            }

            html += '</div>';
            document.getElementById('results').innerHTML = html;
        }

        // é é¢è¼‰å…¥æ™‚åŸ·è¡Œ
        window.addEventListener('DOMContentLoaded', function() {
            addDebugInfo('é é¢è¼‰å…¥å®Œæˆ');
            addDebugInfo(`ç•¶å‰ç¶²å€: ${window.location.href}`);
            loadData();
        });
    </script>
</body>
</html>



